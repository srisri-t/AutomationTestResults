const fs=require("fs"),path=require("path"),reportsDir=process.cwd(),files=fs.readdirSync(reportsDir).filter(e=>e.endsWith(".json")&&"index.json"!==e&&"generate-index.js"!==e),index=files.map(e=>{const t=path.join(reportsDir,e);let s;try{s=JSON.parse(fs.readFileSync(t,"utf8"))}catch{return null}let r="Automation Test Results",n="";if(Array.isArray(s)&&s[0]&&s[0].metadata&&s[0].metadata.timestamp)n=s[0].metadata.timestamp;else if(Array.isArray(s)&&s[0]&&s[0].elements&&s[0].elements[0]&&s[0].elements[0].start_timestamp)n=s[0].elements[0].start_timestamp;else{const e=fs.statSync(t);n=e.mtime.toISOString()}const i=n.replace(/[:.]/g,"-"),a=`Automation-Test-Results-${i}`,o=a+".json";return e!==o&&(fs.renameSync(t,path.join(reportsDir,o)),console.log(`Renamed ${e} -> ${o}`)),{id:a,name:r,date:n}}).filter(Boolean);fs.writeFileSync(path.join(reportsDir,"index.json"),JSON.stringify(index,null,2)),console.log("index.json updated with",index.length,"reports.");